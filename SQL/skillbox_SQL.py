from wget import download
import pandas as pd
import sqlite3

download('https://github.com/lerocha/chinook-database/raw/master/ChinookDatabase/DataSources/Chinook_Sqlite.sqlite')

connect = sqlite3.connect("Chinook_Sqlite.sqlite")
# –°–æ–∑–¥–∞–¥–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å –∑–∞–ø—Ä–æ—Å–æ–º
# –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å —Ç—Ä–æ–π–Ω—ã–º–∏ –∫–∞–≤—ã—á–∫–∞–º–∏: ''' ... '''

query = '''
-- –ë–µ—Ä–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Artist
SELECT *
FROM Artist
'''

# –î–∞–Ω–Ω—ã–µ —Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ä–∞–∑—É –≤ DataFrame
artists = pd.read_sql(query, connect)
print(artists)

# –ü–æ—Å–º–æ—Ç—Ä–∏–º –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –Ω–∞ —Ç–∞–±–ª–∏—Ü—ã Album –∏ Track
albums = pd.read_sql('SELECT * FROM Album', connect)
tracks = pd.read_sql('SELECT * FROM Track', connect)
print(albums)
print(tracks)

# üë®üèªüíª –í—ã–≤–µ–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã Customer –∏ Employee
#WHERE - –£—Å–ª–æ–≤–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏; SELECT - –Ω–∞–±–æ—Ä –∫–æ–ª–æ–Ω–æ–∫ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ * FROM –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã WHERE —É—Å–ª–æ–≤–∏–µ –ü—Ä–∏–º–µ—Ä —É—Å–ª–æ–≤–∏—è:
# "–∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ —Ä–∞–≤–Ω–æ –∫–∞–∫–æ–º—É-—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—é" - colname = X –ï—â–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç Python: ‚Ä¢ –≤ Python —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ "==",
# –∞ –≤ SQL —á–µ—Ä–µ–∑ "=" ‚Ä¢ –≤ Python —Ç–µ–∫—Å—Ç –æ–±—Ä–∞–º–ª—è–µ—Ç—Å—è –∏ –æ–¥–∏–Ω–∞—Ä–Ω—ã–º–∏, –∏ –¥–≤–æ–π–Ω—ã–º–∏ –∫–∞–≤—ã—á–∫–∞–º–∏, –≤ SQL - —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω–∞—Ä–Ω—ã–º–∏(–¥–≤–æ–π–Ω—ã–µ - –¥–ª—è –Ω–∞–∑—ã–≤–∞–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫)
# –ü—Ä–∏–º–µ—Ä: –≤—ã–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
query = '''
SELECT
    name
FROM
    sqlite_schema
WHERE
    type ='table'
'''

pd.read_sql(query, connect)

# üë®üèªüíª –í—ã–≤–µ–¥–∏—Ç–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Track –≤—Å–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö Composer = "Wolfgang Amadeus Mozart"
#DISTINCT, MAX, MIN, AVG –í—ã–≤–æ–¥ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π / –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ / –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ /
# —Å—Ä–µ–¥–Ω–µ–≥–æ SELECT distinct(–∏–º—è –∫–æ–ª–æ–Ω–∫–∏) FROM –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã SELECT MAX(–∏–º—è –∫–æ–ª–æ–Ω–∫–∏) FROM –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã SELECT MIN(–∏–º—è –∫–æ–ª–æ–Ω–∫–∏)
# FROM –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã SELECT MIN(–∏–º—è –∫–æ–ª–æ–Ω–∫–∏), MAX(–∏–º—è –∫–æ–ª–æ–Ω–∫–∏), AVG(–∏–º—è –∫–æ–ª–æ–Ω–∫–∏) FROM –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã

pd.read_sql('SELECT AVG(Bytes) from Track', connect)

# –ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ –µ—Å—Ç—å –∂–∞–Ω—Ä—ã (—Ç–∞–±–ª–∏—Ü–∞ Genre, –∫–æ–ª–æ–Ω–∫–∞ name)
pd.read_sql('SELECT distinct(name) from Genre', connect)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å –ø–æ–º–æ—â—å—é ORDER BY name
pd.read_sql('SELECT distinct(name) FROM Genre ORDER BY name', connect)

# üë®üèªüíª –í—ã–≤–µ–¥–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ü–µ–Ω—ã —Ç—Ä–µ–∫–∞ UnitPrice —Ç–∞–±–ª–∏—Ü—ã Track. –ö–∞–∫–æ–π —Ü–µ–Ω–æ–≤–æ–π —Ä–∞–∑–±—Ä–æ—Å?
# üë®üèªüíª –í—ã–≤–µ–¥–∏—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è Bytes —Ç–∞–±–ª–∏—Ü—ã Track

#JOIN –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü.–í —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Å—ã–ª–∫—ä–∞—é—Ç—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞ —Å –ø–æ–º–æ—â—å—é –∫–æ–ª–æ–Ω–æ–∫ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏, —É–∫–∞–∑—ã–≤–∞—é—â–∏–º–∏ –Ω–∞ –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü–µ
# –û–±—ä–µ–¥–∏–Ω–∏–º –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–µ–∫–∞—Ö –∏ –∞–ª—å–±–æ–º–∞—Ö
query = '''
SELECT *
FROM Track
JOIN Album
ON Track.AlbumId = Album.AlbumId
'''
pd.read_sql(query, connect)

# –û–±—ä–µ–¥–∏–Ω–∏–º –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã–µ –æ–± –∞–ª—å–±–æ–º–∞—Ö –∏ –∞—Ä—Ç–∏—Å—Ç–∞—Ö
query = '''
SELECT *
FROM Artist
JOIN Album
ON Artist.ArtistId = Album.ArtistId
'''
pd.read_sql(query, connect)

# üë®üèªüíª –û–±—ä–µ–¥–∏–Ω–∏—Ç–µ –≤—Å–µ 3 —Ç–∞–±–ª–∏—Ü—ã –≤ –æ–¥–Ω—É, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ—Å–ª–µ–¥–∏—Ç—å —Å–≤—è–∑—å —Ç—Ä–µ–∫-–∞—Ä—Ç–∏—Å—Ç

#–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ üìù –ê–≥—Ä–µ–≥–∞—Ü–∏—è - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞ –Ω–∞–±–æ—Ä–µ –∑–Ω–∞—á–µ–Ω–∏–π –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –≤ –æ–¥–Ω–æ.–ù–∞–ø—Ä–∏–º–µ—Ä,
# –≤–∑—è—Ç–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏–ª–∏ –ø–æ–¥—Å—á–µ—Ç —á–∏—Å–ª–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –≥—Ä—É–ø–ø–µ –ú—ã –º–æ–∂–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞–∫–æ–≥–æ -
# —Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—á–∏—Ç–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã üìù COUNT - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ SELECT COUNT(*) FROM
# —Ç–∞–±–ª–∏—Ü–∞ SELECT COUNT(DISTINCT(–∫–æ–ª–æ–Ω–∫–∞)) FROM —Ç–∞–±–ª–∏—Ü–∞
# –û—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å, —Å–∫–æ–ª—å–∫–æ –∞—Ä—Ç–∏—Å—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
pd.read_sql('SELECT count(*) from Artist', connect)

#–°—Ç—Ä–æ—á–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤ –∫–æ–ª–æ–Ω–∫–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ –≥—Ä—É–ø–ø—É, –∏ –ø–æ –Ω–∏–º —Å–º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∞–≥—Ä–µ–≥–∞—Ü–∏–∏:
# SELECT –∫–æ–ª–æ–Ω–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, COUNT(–∫–æ–ª–æ–Ω–∫–∞1), AVG(–∫–æ–ª–æ–Ω–∫–∞2) FROM —Ç–∞–±–ª–∏—Ü–∞ GROUP BY –∫–æ–ª–æ–Ω–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
# –ê —Ç–µ–ø–µ—Ä—å —Å–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∞–ª—å–±–æ–º–æ–≤ –ø–æ –∞—Ä—Ç–∏—Å—Ç–∞–º –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ –∞–ª—å–±–æ–º–æ–≤ —É –∫–∞–∂–¥–æ–≥–æ –∞—Ä—Ç–∏—Å—Ç–∞
query = '''
SELECT ArtistId, COUNT(title)
FROM Album
GROUP BY ArtistId
'''

pd.read_sql(query, connect)

query = '''
SELECT ArtistId, COUNT(title)
FROM Album
GROUP BY ArtistId
ORDER BY COUNT(title)
'''

pd.read_sql(query, connect)

#–ù–∏—á–µ–≥–æ –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ, –¥–∞–≤–∞–π—Ç–µ –¥–æ–±–∞–≤–∏–º —Å—é–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∞–º–æ–º –∞—Ä—Ç–∏—Å—Ç–µ
#–í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –ú—ã –º–æ–∂–µ–º –¥–µ–ª–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—ã SELECT... FROM( SELECT...FROM... ) ...
# –û–±—ä–µ–¥–∏–Ω–∏–º –∑–∞–ø—Ä–æ—Å GROUP BY –∏ JOIN
query = '''
SELECT name, COUNT(title)
FROM (
    SELECT *
    FROM Artist
    JOIN Album
    ON Artist.ArtistId = Album.ArtistId
)
GROUP BY name
'''

pd.read_sql(query, connect)

# –û–±—ä–µ–¥–∏–Ω–∏–º –∑–∞–ø—Ä–æ—Å GROUP BY –∏ JOIN
query = '''
SELECT name, COUNT(title)
FROM (
    SELECT *
    FROM Artist
    JOIN Album
    ON Artist.ArtistId = Album.ArtistId
)
GROUP BY name
ORDER BY COUNT(title)
'''

print(pd.read_sql(query, connect))

# üë®üèªüíª –í–æ–∑—å–º–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∏–∑ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è "–û–±—ä–µ–¥–∏–Ω–∏—Ç–µ –≤—Å–µ 3 —Ç–∞–±–ª–∏—Ü—ã –≤ –æ–¥–Ω—É" –∏ –≤—ã–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–∫–æ–≤, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º

# üë®üèªüíª –û–±—ä–µ–¥–∏–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É Track –∏ —Ç–∞–±–ª–∏—Ü—É InvoiceLine. –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±—ã–ª –∫—É–ø–ª–µ–Ω –∫–∞–∂–¥—ã–π —Ç—Ä–µ–∫? (–ü–æ–¥—Å—á–µ—Ç –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ –∫–æ–ª–æ–Ω–∫–µ InvoiceID)

# üë®üèªüíª –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å: –∫–∞–∫–æ–π –∞–≤—Ç–æ—Ä –Ω–∞–∏–±–æ–ª–µ–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏ –ø–æ–ø—É–ª—è—Ä–µ–Ω? –ß—å–∏ —Ç—Ä–µ–∫–∏ –ø–æ–∫—É–ø–∞—é—Ç —á–∞—â–µ –≤—Å–µ–≥–æ? –î–ª—è —ç—Ç–æ–≥–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –∞–∂ 4 —Ç–∞–±–ª–∏—Ü—ã :)
